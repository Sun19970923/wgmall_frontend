"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[303],{23732:function(S,v,r){r.d(v,{$A:function(){return A},FL:function(){return N},H:function(){return P},IL:function(){return M},JR:function(){return F},Kn:function(){return o},S4:function(){return k},Ue:function(){return s},Uy:function(){return I},Vb:function(){return U},_U:function(){return f},an:function(){return p},bZ:function(){return R},eY:function(){return Z},iJ:function(){return C},jw:function(){return T},nn:function(){return O},o$:function(){return i},sg:function(){return L},um:function(){return u},vZ:function(){return D},wX:function(){return b},x4:function(){return y},yw:function(){return t},z2:function(){return l}});var a=r(48047),h=r(53827),g=h.Z.create({baseURL:"https://api.xxzh.cc",withCredentials:!1,crossDomain:!0,timeout:1e4});function i(e){return g({url:"/user/captcha/getCaptcha",withCredentials:!1,method:"get",params:e})}function p(e){return(0,a.Z)({url:"/user/captcha/getCaptcha",withCredentials:!1,method:"get",params:e})}function l(e){return(0,a.Z)({url:"/auth/register",withCredentials:!1,method:"post",data:e})}function u(e){return(0,a.Z)({url:"/user/user-detail/"+e.userId,withCredentials:!1,method:"get"})}function d(e){return request({url:"/wishlist/"+e.userId,withCredentials:!1,method:"get"})}function t(e){return(0,a.Z)({url:"/message/inbox",withCredentials:!1,method:"get",params:e})}function s(e){var _=e.id;return delete e.id,(0,a.Z)({url:"/address/create?userId="+_,withCredentials:!1,method:"post",data:e})}function o(e){return(0,a.Z)({url:"/address/get",withCredentials:!1,method:"get",params:e})}function f(e){return(0,a.Z)({url:"/address/update?userId="+e.id,withCredentials:!1,method:"post",data:e})}function m(e){return request({url:"/redbag/draw",withCredentials:!1,method:"post",data:e})}function n(e){return request({url:"/user/profit",withCredentials:!1,method:"get",params:e})}function y(e){return(0,a.Z)({url:"/auth/login",withCredentials:!1,method:"post",data:e})}function x(e){return request({url:"/redbag/signin",withCredentials:!1,method:"post",data:e})}function T(e){return(0,a.Z)({url:"/redbag/signin-and-draw",withCredentials:!1,method:"post",data:e})}function O(e){return(0,a.Z)({url:"/seller/apply",withCredentials:!1,method:"post",data:e})}function C(e){return(0,a.Z)({url:"/loan/apply",withCredentials:!1,method:"post",data:e})}function P(e){return(0,a.Z)({url:"/loan/loan",withCredentials:!1,method:"post",data:e})}function k(e){return(0,a.Z)({url:"/loan/repay",withCredentials:!1,method:"post",data:e})}function M(e){return(0,a.Z)({url:"/withdrawal-records/user",withCredentials:!1,method:"post",data:e})}function R(e){return(0,a.Z)({url:"/recharge-records/username",withCredentials:!1,method:"get",params:e})}function b(e){return(0,a.Z)({url:"/recharge-records/user",withCredentials:!1,method:"post",data:e})}function F(e){return(0,a.Z)({url:"/withdrawal-records/username",withCredentials:!1,method:"get",params:e})}function N(e){return(0,a.Z)({url:"/shop/user/"+e,withCredentials:!1,method:"get"})}function Z(e){return(0,a.Z)({url:"/user/info/"+e,withCredentials:!1,method:"get"})}function I(e){return(0,a.Z)({url:"/products/uploader-to-userid?uploader="+e.uploader,withCredentials:!1,method:"get"})}function L(e){return(0,a.Z)({url:"/user/eth/get",withCredentials:!1,method:"get",params:e})}function U(e){return(0,a.Z)({url:"/user/tron/get",withCredentials:!1,method:"get",params:e})}function D(e){return(0,a.Z)({url:"/user/eth/set",withCredentials:!1,method:"put",data:e})}function A(e){return(0,a.Z)({url:"/user/tron/set",withCredentials:!1,method:"put",data:e})}function W(){return fetch("https://api.ipify.org?format=json")}},48047:function(S,v,r){var a=r(31759),h=r.n(a),g=r(53827),i=r(50862),p=r(49634),l=g.Z.create({baseURL:"https://api.xxzh.cc",withCredentials:!1,crossDomain:!0,timeout:1e5});l.interceptors.request.use(function(u){if(u.url==="/auth/register"||u.url==="/auth/login")return u;(u.url==="/user/apply"||u.url==="/loan/apply")&&(u.headers["Content-Type"]="multipart/form-data");var d=localStorage.getItem("token");return d&&(u.headers.Authorization="Bearer "+d),u},function(u){return console.log(u),Promise.reject(u)}),l.interceptors.response.use(function(u){var d,t=u.data;if(console.log("response-->",t),Array.isArray(t))return Promise.resolve(t);if((d=t.data)!==null&&d!==void 0&&d.token&&(localStorage.setItem("token",t.data.token),localStorage.setItem("userInfo",JSON.stringify(t.data.user))),t.code!==200)return i.FN.show({icon:"fail",content:t.message}),Promise.resolve(t);if(t.code===200||t.message==="SUCCESS")return Promise.resolve(t);if(t.code===305||t.code===306){Promise.reject(t||"error");return}else return t.code===403?(i.FN.show({icon:"fail",content:t.message}),p.history.push("/login"),Promise.resolve(t||"error")):Promise.reject(t||"error")},function(u){return console.log(u,"error"),u.status===403&&(i.FN.show({icon:"fail",content:u.message}),localStorage.removeItem("token"),setTimeout(function(){p.history.push("/login")},1e3)),console.log("request error"+u,h()(u)),Promise.reject(u)}),v.Z=l},4090:function(S,v,r){r.d(v,{Bi:function(){return l},Vj:function(){return u},c9:function(){return d},dN:function(){return p}});var a=r(25298),h=r.n(a),g=r(17069),i=r.n(g);function p(t){return isNaN(t)?"0.00":Number(t).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}function l(t){var s=new Date(t),o=s.getFullYear(),f=String(s.getMonth()+1).padStart(2,"0"),m=String(s.getDate()).padStart(2,"0"),n="".concat(o,"-").concat(f,"-").concat(m);return n}function u(t,s,o){for(var f={},m=100/o,n=0;n<=o;n++){var y=n*m,x=(t+(s-t)*y/100).toFixed(2);f[y]=parseFloat(x)}return f}var d=function(){function t(s){h()(this,t),this.url=s,this.ws=null,this.listeners=[],this.onOpenCallbacks=[]}return i()(t,[{key:"connect",value:function(){var o=this;this.ws||(this.ws=new window.WebSocket(this.url),this.ws.onopen=function(){o.onOpenCallbacks.forEach(function(f){return f()})},this.ws.onmessage=function(f){var m=f.data;try{m=JSON.parse(m)}catch(n){}o.listeners.forEach(function(n){return n(m)})})}},{key:"send",value:function(o){console.log(this.ws,"this.ws"),!(!this.ws||this.ws.readyState!==1)&&(typeof o!="string"&&(o=JSON.stringify(o)),this.ws.send(o))}},{key:"onMessage",value:function(o){this.listeners.push(o)}},{key:"close",value:function(){this.ws&&(this.ws.close(),this.ws=null)}},{key:"onOpen",value:function(o){this.onOpenCallbacks.push(o)}}]),t}()},48452:function(S,v,r){var a=r(50862),h=r(75271),g=r(5791),i=r(52676),p=function(u){var d=u.title,t=(0,g.s0)(),s=function(){t(-1)};return(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(a.l2,{onBack:s,style:{background:"#fff",position:"sticky",top:0,zIndex:1e3},children:d})})};v.Z=p},66345:function(S,v,r){r.r(v),r.d(v,{default:function(){return y}});var a=r(90228),h=r.n(a),g=r(87999),i=r.n(g),p=r(48305),l=r.n(p),u=r(75271),d=r(48452),t=r(50862),s={finance:"finance___QHcLo",title:"title___rh5LJ",content:"content___dOvsR",number:"number___TJ4qR",button:"button____Gz64",overlayContent:"overlayContent___xiAgF"},o=r(23732),f=r(5791),m=r(4090),n=r(52676);function y(){var x=(0,f.s0)(),T=(0,u.useState)({}),O=l()(T,2),C=O[0],P=O[1],k=(0,u.useState)(0),M=l()(k,2),R=M[0],b=M[1],F=(0,u.useState)(0),N=l()(F,2),Z=N[0],I=N[1],L=(0,u.useState)(""),U=l()(L,2),D=U[0],A=U[1],W=function(){var _=i()(h()().mark(function w(){var E,B;return h()().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return E=JSON.parse(localStorage.getItem("userInfo")),P(E),j.next=4,(0,o.um)({userId:E.id});case 4:B=j.sent,B.code==200&&P(B.data.user);case 6:case"end":return j.stop()}},w)}));return function(){return _.apply(this,arguments)}}(),e=function(){var _=i()(h()().mark(function w(){var E;return h()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(Z!=0){c.next=6;break}return c.next=3,(0,o.H)({userId:C.id,loanAmount:D});case 3:c.t0=c.sent,c.next=9;break;case 6:return c.next=8,(0,o.S4)({userId:C.id,repayAmount:D});case 8:c.t0=c.sent;case 9:E=c.t0,E.code==200&&(t.FN.show({content:E.message,icon:"success"}),b(!1),A(""),W());case 11:case"end":return c.stop()}},w)}));return function(){return _.apply(this,arguments)}}();return(0,u.useEffect)(function(){W()},[]),(0,n.jsxs)("div",{style:{padding:"0 0 32px 0"},className:s.address,children:[(0,n.jsx)(d.Z,{title:"\u6211\u7684\u8D37\u6B3E",style:{height:"100px"}}),(0,n.jsx)(t.zd,{visible:R,onMaskClick:function(){return b(!1)},children:(0,n.jsx)("div",{className:s.overlayContent,children:(0,n.jsxs)(t.Zb,{children:[(0,n.jsxs)("h1",{children:[Z==0?"\u501F\u6B3E":"\u8FD8\u6B3E","\u7533\u8BF7"]}),(0,n.jsxs)("div",{className:s.content,children:[(0,n.jsx)("input",{type:"number",value:D,onChange:function(w){return A(w.target.value)}}),(0,n.jsx)("div",{className:s.button,onClick:function(){return e()},children:"Submit"})]})]})})}),(0,n.jsx)("div",{className:s.finance,children:C.borrowable?(0,n.jsxs)(t.Zb,{children:[(0,n.jsx)("div",{className:s.title,children:(0,n.jsx)("span",{children:"\u8D37\u6B3E\u7533\u8BF7"})}),(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"space-around"},children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:s.content,children:"\u4F60\u7684\u989D\u5EA6"}),(0,n.jsxs)("div",{className:s.number,children:["$ ",(0,m.dN)(C.credit||0)]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:s.content,children:"\u4F60\u7684\u8D1F\u503A"}),(0,n.jsxs)("div",{className:s.number,children:["$ ",(0,m.dN)(C.debtAmount||0)]})]})]}),(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"space-around"},children:[(0,n.jsx)("div",{className:s.button,style:{background:"#f5f7fa",color:"#000"},onClick:function(){I(0),b(!0)},children:"\u501F\u6B3E"}),(0,n.jsx)("div",{className:s.button,onClick:function(){b(!0),I(1)},children:"\u8FD8\u6B3E"})]})]}):(0,n.jsxs)(t.Zb,{children:[(0,n.jsx)("div",{className:s.title,children:(0,n.jsx)("span",{children:"\u8D37\u6B3E\u7533\u8BF7"})}),(0,n.jsx)("div",{className:s.content,children:"\u4F60\u7684\u989D\u5EA6\u662F"}),(0,n.jsx)("div",{className:s.number,children:"?????"}),(0,n.jsx)("div",{className:s.button,onClick:function(){x("/user/approve")},children:"\u7533\u8BF7\u8D37\u6B3E"})]})}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{})]})}}}]);
